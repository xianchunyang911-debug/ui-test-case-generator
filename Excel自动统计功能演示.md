# Excel自动统计功能演示

## 功能说明

Excel文件已升级，支持**自动统计走查进度**功能！

### 核心功能
1. ✅ "是否通过"列改为下拉选择（待测试/是/否）
2. ✅ 用例汇总表自动计算完成数量
3. ✅ 用例汇总表自动计算完成率
4. ✅ 实时反映走查进度

## 使用演示

### 步骤1：打开Excel文件
打开 `UI用例/跨域训练-UI走查用例-1.xlsx`

### 步骤2：查看用例汇总
点击第一个Sheet"用例汇总"，可以看到：

```
序号 | 模块名称           | 用例数量 | 高优先级 | 中优先级 | 低优先级 | 完成数量 | 完成率 | 备注
-----|-------------------|---------|---------|---------|---------|---------|--------|-----
1    | 跨域训练首页       | 24      | 20      | 4       | 0       | 0       | 0%     |
2    | 新建跨域训练任务   | 29      | 25      | 4       | 0       | 0       | 0%     |
3    | 跨域训练任务详情   | 11      | 9       | 2       | 0       | 0       | 0%     |
...
```

初始状态下，所有模块的完成数量为0，完成率为0%。

### 步骤3：执行走查
点击第二个Sheet"跨域训练首页"，开始执行走查：

1. 找到第一个用例 UI-TC001
2. 检查页面标题的字体、字号、颜色
3. 点击"是否通过"列的单元格（H列）
4. 点击右侧出现的下拉箭头 ▼
5. 选择测试结果：
   - **是**：如果UI符合预期
   - **否**：如果UI不符合预期
   - **待测试**：如果暂时跳过

### 步骤4：查看进度更新
完成几个用例的测试后，返回"用例汇总"Sheet：

```
序号 | 模块名称           | 用例数量 | 高优先级 | 中优先级 | 低优先级 | 完成数量 | 完成率 | 备注
-----|-------------------|---------|---------|---------|---------|---------|--------|-----
1    | 跨域训练首页       | 24      | 20      | 4       | 0       | 5       | 21%    |  ← 自动更新！
2    | 新建跨域训练任务   | 29      | 25      | 4       | 0       | 0       | 0%     |
3    | 跨域训练任务详情   | 11      | 9       | 2       | 0       | 0       | 0%     |
...
```

可以看到"跨域训练首页"的完成数量和完成率已经自动更新！

## 工作原理

### 下拉选择
使用Excel的**数据验证**功能：
```
数据验证类型：列表
来源："待测试,是,否"
应用范围：H2:H1000（是否通过列）
```

### 完成数量公式
在"用例汇总"Sheet的G列（完成数量）使用公式：
```excel
=COUNTIF('跨域训练首页'!H:H,"是")+COUNTIF('跨域训练首页'!H:H,"否")
```

**公式说明**：
- `COUNTIF('跨域训练首页'!H:H,"是")`：统计"跨域训练首页"Sheet中H列（是否通过）值为"是"的单元格数量
- `COUNTIF('跨域训练首页'!H:H,"否")`：统计值为"否"的单元格数量
- 两者相加得到已完成的用例数量（无论通过还是不通过，只要测试了就算完成）

### 完成率公式
在"用例汇总"Sheet的H列（完成率）使用公式：
```excel
=IF(C2=0,"0%",TEXT(G2/C2,"0%"))
```

**公式说明**：
- `IF(C2=0,"0%",...)` ：如果用例数量为0，显示"0%"
- `TEXT(G2/C2,"0%")`：否则计算完成数量/用例数量，并格式化为百分比

## 优势

### 1. 自动化
- ✅ 无需手动统计完成数量
- ✅ 无需手动计算完成率
- ✅ 实时反映最新进度

### 2. 准确性
- ✅ 避免人工统计错误
- ✅ 公式计算精确
- ✅ 数据一致性高

### 3. 便捷性
- ✅ 下拉选择快速操作
- ✅ 一键查看整体进度
- ✅ 支持团队协作

## 注意事项

### 1. 不要删除公式
"用例汇总"Sheet的G列和H列包含公式，请勿删除或覆盖。

### 2. 保持Sheet名称一致
公式中引用了Sheet名称，如果修改Sheet名称，需要同步更新公式。

### 3. 只统计"是"和"否"
完成数量只统计选择了"是"或"否"的用例，"待测试"不计入完成数量。

### 4. Excel版本要求
需要Excel 2007及以上版本，或WPS表格。

## 常见问题

### Q1: 为什么完成率没有更新？
A: 可能需要手动刷新：
1. 按 F9 键刷新所有公式
2. 或者切换到其他Sheet再切换回来
3. 或者保存文件后重新打开

### Q2: 如何查看公式？
A: 点击"用例汇总"Sheet的G列或H列单元格，在上方的公式栏可以看到公式。

### Q3: 可以修改公式吗？
A: 可以，但需要了解Excel公式语法。建议不要修改，除非你知道自己在做什么。

### Q4: 如果新增了用例，公式还有效吗？
A: 有效。公式使用了整列引用（H:H），会自动包含新增的行。

### Q5: 可以导出为PDF吗？
A: 可以，但公式会变成静态值。建议在走查完成后再导出。

## 示例场景

### 场景1：单人走查
1. 打开Excel文件
2. 从第一个模块开始，逐个用例执行走查
3. 每完成一个用例，选择"是"或"否"
4. 定期查看"用例汇总"了解进度
5. 全部完成后，完成率达到100%

### 场景2：团队协作
1. 将不同模块分配给不同人员
2. 每个人负责自己的模块
3. 在"是否通过"列选择测试结果
4. 团队负责人查看"用例汇总"了解整体进度
5. 识别进度落后的模块，及时跟进

### 场景3：分阶段走查
1. 第一阶段：只走查高优先级用例
2. 使用筛选功能，筛选"高优先级"
3. 完成后查看"用例汇总"的完成率
4. 第二阶段：走查中、低优先级用例
5. 最终完成率达到100%

## 技术细节

### Excel公式详解

#### COUNTIF函数
```excel
COUNTIF(range, criteria)
```
- `range`：要统计的单元格区域
- `criteria`：统计条件

示例：
```excel
=COUNTIF(A1:A10, "是")  // 统计A1:A10区域中值为"是"的单元格数量
```

#### TEXT函数
```excel
TEXT(value, format_text)
```
- `value`：要格式化的值
- `format_text`：格式代码

示例：
```excel
=TEXT(0.25, "0%")  // 将0.25格式化为"25%"
```

#### IF函数
```excel
IF(logical_test, value_if_true, value_if_false)
```
- `logical_test`：逻辑判断
- `value_if_true`：判断为真时的返回值
- `value_if_false`：判断为假时的返回值

示例：
```excel
=IF(A1=0, "空", A1)  // 如果A1为0，显示"空"，否则显示A1的值
```

### 数据验证详解

#### 创建下拉列表
1. 选中要添加下拉列表的单元格区域
2. 点击"数据"选项卡
3. 点击"数据验证"
4. 验证条件选择"列表"
5. 来源输入："待测试,是,否"
6. 点击"确定"

#### 复制数据验证
1. 选中已有下拉列表的单元格
2. 复制（Ctrl+C）
3. 选中目标单元格
4. 粘贴（Ctrl+V）

## 总结

通过使用Excel的**数据验证**和**公式**功能，实现了UI走查用例的自动统计和进度跟踪。这大大提高了走查效率，减少了人工统计的工作量，让团队可以更专注于UI质量的验证。

🎉 现在就打开Excel文件，开始你的UI走查之旅吧！
