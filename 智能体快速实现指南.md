# 智能体快速实现指南

## 🎯 目标
将UI走查用例生成功能封装为Kiro智能体，实现自动化生成。

## 📋 前置条件
- ✅ 已有完整的规则文档
- ✅ 已有Python转换脚本
- ✅ 已有模板文件
- ✅ Kiro IDE已安装

## 🚀 实现步骤

### 步骤1: 创建Steering规则（已完成）

Steering规则文件已创建：
```
.kiro/steering/ui-test-gen.md
```

这个文件定义了智能体的行为规则。

### 步骤2: 创建Kiro Hook

#### 2.1 打开Hook UI
1. 按 `Cmd+Shift+P` 打开命令面板
2. 输入 `Open Kiro Hook UI`
3. 点击进入Hook管理界面

#### 2.2 创建新Hook
点击 "Create New Hook" 按钮

#### 2.3 配置Hook

**基本信息**：
- **Name**: `UI走查用例生成`
- **Description**: `自动生成UI走查用例和走查计划`

**触发条件**：
- **Trigger Type**: `File Save`
- **File Pattern**: `*需求文档*.md`

**执行Prompt**：
```
你是UI走查用例生成专家。用户刚刚保存了需求文档，请执行以下任务：

## 任务
1. 读取当前保存的需求文档内容
2. 根据 #ui-test-gen 上下文规则生成UI走查用例
3. 自动判断输出格式（用例数>50或模块数>3时使用Excel格式）
4. 生成以下文件：
   - UI走查用例文件（存放在 UI用例/ 目录）
   - UI走查计划文档（存放在项目根目录）
   - 快速开始指南（存放在项目根目录）

## 参考规则
- AI生成UI走查用例规则.md
- AI生成Excel多Sheet UI走查用例规则.md
- UI走查计划模板.md

## 输出要求
- 用例编号连续（UI-TC001, UI-TC002...）
- 优先级合理分配
- 预期结果具体可验证
- 如果生成Excel格式，执行 csv_to_excel_multi_sheet.py 脚本转换

请开始执行任务。
```

**高级选项**：
- **Auto-approve**: 关闭（首次使用建议手动确认）
- **Run in background**: 开启

#### 2.4 保存Hook
点击 "Save" 保存Hook配置

### 步骤3: 测试智能体

#### 3.1 准备测试文件
确保有一个需求文档文件，文件名包含"需求文档"，如：
```
需求文档.md
跨域训练需求文档.md
```

#### 3.2 触发Hook
1. 打开需求文档
2. 做一个小修改（如添加空格）
3. 保存文件（Cmd+S）
4. 观察Kiro是否弹出Hook执行提示

#### 3.3 确认执行
1. 查看Hook执行的Prompt
2. 点击 "Approve" 确认执行
3. 等待生成完成

#### 3.4 检查输出
检查以下文件是否生成：
```
UI用例/
  └── {功能名称}-UI走查用例-1.csv
  └── {功能名称}-UI走查用例-1.xlsx (如果用例数>50)

{功能名称}-UI走查计划.md
快速开始.md
```

## 🎨 方式2: 通过Chat使用

如果不想使用Hook，也可以直接在Chat中使用：

### 使用方法
在Kiro Chat中输入：
```
#ui-test-gen 请根据 #需求文档.md 生成UI走查用例
```

或者：
```
请根据需求文档.md生成UI走查用例，使用Excel多Sheet格式
```

## 🔧 方式3: 通过命令使用

### 创建自定义命令

#### 3.1 打开命令配置
1. 按 `Cmd+Shift+P`
2. 输入 `Preferences: Open User Settings`

#### 3.2 添加自定义命令
在设置中添加：
```json
{
  "kiro.commands": [
    {
      "id": "generateUITestCases",
      "title": "生成UI走查用例",
      "when": "editorLangId == markdown",
      "prompt": "根据当前打开的需求文档，使用 #ui-test-gen 规则生成UI走查用例"
    }
  ]
}
```

#### 3.3 使用命令
1. 打开需求文档
2. 按 `Cmd+Shift+P`
3. 输入 `生成UI走查用例`
4. 回车执行

## 📊 方式4: 批量生成

如果有多个需求文档需要生成用例：

### 创建批量脚本
创建 `batch_generate.sh`:
```bash
#!/bin/bash

# 批量生成UI走查用例
for file in *需求文档*.md; do
    echo "处理: $file"
    # 调用Kiro CLI（如果支持）
    # 或者使用Python脚本
done
```

## 🎯 最佳实践

### 1. 需求文档规范
为了让智能体更好地识别，需求文档应该：
- ✅ 使用清晰的标题层级（# ## ###）
- ✅ 每个功能模块独立章节
- ✅ 包含字段说明表格
- ✅ 说明页面布局和交互流程

### 2. 文件命名规范
- 需求文档：`{功能名称}需求文档.md`
- 输出目录：`UI用例/`
- 用例文件：`{功能名称}-UI走查用例-1.csv/xlsx`

### 3. 版本管理
- 需求文档使用Git管理
- 生成的用例文件也纳入版本控制
- 使用有意义的commit message

### 4. 团队协作
- 统一使用相同的规则文件
- 定期同步规则更新
- 分享最佳实践

## 🐛 故障排查

### 问题1: Hook没有触发
**可能原因**：
- 文件名不匹配模式
- Hook被禁用
- Kiro版本不支持

**解决方案**：
1. 检查文件名是否包含"需求文档"
2. 在Hook UI中检查Hook状态
3. 查看Kiro日志

### 问题2: 生成失败
**可能原因**：
- 需求文档格式不规范
- 规则文件缺失
- Python脚本执行失败

**解决方案**：
1. 检查需求文档格式
2. 确认规则文件存在
3. 手动执行Python脚本测试

### 问题3: Excel文件无法打开
**可能原因**：
- openpyxl库未安装
- 文件权限问题
- 文件损坏

**解决方案**：
```bash
# 安装openpyxl
pip install openpyxl

# 检查文件权限
ls -l UI用例/*.xlsx

# 重新生成
python3 csv_to_excel_multi_sheet.py
```

## 📈 进阶功能

### 1. 添加自动通知
在Hook中添加通知功能：
```javascript
// 生成完成后发送通知
notification.show({
  title: 'UI走查用例生成完成',
  message: '已生成 113 个用例，11 个模块',
  actions: ['查看文件', '关闭']
});
```

### 2. 集成到工作流
将智能体集成到开发工作流：
```
需求评审 → 保存需求文档 → 自动生成用例 → 分配走查任务 → 执行走查 → 问题跟踪
```

### 3. 添加质量检查
在生成后自动检查：
- 用例数量是否合理
- 优先级分布是否均衡
- 是否覆盖所有模块
- 预期结果是否具体

## 🎉 完成检查清单

- [ ] Steering规则文件已创建
- [ ] Kiro Hook已配置
- [ ] 测试文件已准备
- [ ] Hook触发成功
- [ ] 用例文件已生成
- [ ] Excel格式正确
- [ ] 走查计划已生成
- [ ] 团队成员已培训

## 📚 相关文档

- `UI走查用例生成智能体设计方案.md` - 完整设计方案
- `.kiro/steering/ui-test-gen.md` - Steering规则
- `AI生成UI走查用例规则.md` - CSV格式规则
- `AI生成Excel多Sheet UI走查用例规则.md` - Excel格式规则
- `csv_to_excel_multi_sheet.py` - 转换脚本

## 🚀 下一步

1. **立即行动**：按照步骤2创建Hook
2. **测试验证**：使用现有需求文档测试
3. **优化调整**：根据实际使用情况优化Prompt
4. **团队推广**：分享给团队成员使用

---

**祝你成功搭建智能体！** 🎊
