# 模块选择功能使用说明

## ✅ 问题已修复

之前遇到的错误已经全部修复：
1. ✅ `'Module' object is not subscriptable` - 已修复
2. ✅ `'dict' object has no attribute 'id'` - 已修复
3. ✅ 数据格式不一致问题 - 已修复

## 🚀 如何使用新功能

### 第一步：清除旧数据（重要！）

如果你之前已经使用过应用并识别过模块，**必须先清除旧数据**：

1. 打开浏览器访问 http://localhost:8501
2. 点击右上角的 **"🗑️ 清除数据"** 按钮
3. 页面会自动刷新

### 第二步：上传需求文档

1. 切换到 **"📤 上传文档"** 标签页
2. 点击 **"选择需求文档"** 按钮
3. 选择你的需求文档（支持 .md、.txt、.docx 格式）
4. 文档上传后会显示预览

**测试文档**：项目根目录下有一个 `test_document.md` 可以用来测试

### 第三步：识别模块/页面

1. 在文档预览下方，点击 **"🔍 模块/页面识别"** 按钮
2. 系统会自动识别文档中的所有模块和页面
3. 识别完成后会显示：
   - ✅ 识别成功提示
   - 📋 识别到的模块数量
   - 🎈 庆祝动画

### 第四步：选择需要的模块

识别成功后，会显示模块选择界面：

#### 模块列表
- ☑️ 每个模块前面都有复选框
- 默认全部选中
- 点击复选框可以选择/取消选择
- **重要**：点击复选框时页面不会刷新！

#### 快捷操作
- **[全选]** - 一键选中所有模块
- **[全不选]** - 一键取消所有选择
- **[重新识别]** - 清除当前识别结果，重新开始

#### 搜索功能
- 在搜索框中输入关键词
- 实时过滤模块列表
- 支持按模块名称和描述搜索

### 第五步：选择建议选项（可选）

在模块列表下方，有4个建议选项：

- ☐ **全局页面** - 生成通用组件和导航相关的用例
- ☐ **场景流程** - 生成用户操作流程和步骤相关的用例
- ☐ **异常场景** - 生成错误处理和边界情况相关的用例
- ☐ **上下游验证** - 生成数据流转和接口验证相关的用例

**提示**：
- 可以同时选择多个建议选项
- 建议选项会影响AI生成的用例内容
- 如果不选择，会生成标准的UI走查用例

### 第六步：生成UI走查用例

1. 确认已选择需要的模块
2. 点击 **"🚀 生成UI走查用例"** 按钮
3. 系统会显示生成进度
4. 生成完成后会显示：
   - ✅ 生成成功提示
   - 📊 用例总数和模块数量
   - 🎈 庆祝动画

**注意**：
- 如果未选择任何模块，生成按钮会被禁用
- 会显示提示信息："⚠️ 请至少选择一个模块后再生成用例"

### 第七步：下载和查看结果

1. 切换到 **"📊 生成结果"** 标签页
2. 查看统计信息：
   - 用例总数
   - 模块数量
   - 输出格式
3. 点击 **"📥 下载用例文件"** 按钮下载CSV文件
4. 在预览区域查看生成的用例

## 🎯 使用技巧

### 1. 选择性生成
- 不需要为所有模块生成用例
- 只选择当前迭代需要测试的模块
- 可以多次生成，每次选择不同的模块

### 2. 使用建议选项
- **全局页面**：适合测试导航、头部、底部等通用组件
- **场景流程**：适合测试完整的用户操作流程
- **异常场景**：适合测试错误处理和边界情况
- **上下游验证**：适合测试数据流转和接口调用

### 3. 搜索功能
- 当模块很多时，使用搜索快速定位
- 输入模块名称的关键词即可过滤
- 搜索不会影响选中状态

### 4. 数据持久化
- 刷新页面后，识别结果和选择状态会保持
- 关闭浏览器后数据会清除
- 可以随时点击"清除数据"重新开始

## 🔧 配置AI增强（可选）

如果想使用AI智能识别和生成：

1. 在左侧边栏勾选 **"使用AI生成"**
2. 选择AI服务：
   - **DeepSeek**（推荐，性价比高）
   - **OpenAI**（GPT-4）
3. 输入API Key
4. 重新识别和生成

**AI的优势**：
- 更准确的模块识别
- 更智能的模块描述和类型推断
- 更全面的用例生成
- 建议选项效果更明显

## ❓ 常见问题

### Q1: 点击"模块/页面识别"后报错？
**A**: 请先点击"清除数据"按钮，清除旧的缓存数据，然后重新上传文档。

### Q2: 识别不到模块？
**A**: 
- 检查文档是否包含明确的标题结构（如 `## 标题`）
- 确保文档格式正确（Markdown、Word）
- 尝试使用AI识别模式（需要配置API Key）

### Q3: 点击复选框后页面刷新了？
**A**: 这不应该发生。如果发生了，请报告这个bug。正常情况下点击复选框不会刷新页面。

### Q4: 生成的用例不符合预期？
**A**: 
- 尝试使用建议选项来引导生成方向
- 使用AI生成模式（需要配置API Key）
- 检查需求文档是否描述清晰

### Q5: 如何重新开始？
**A**: 点击右上角的"清除数据"按钮，然后重新上传文档。

## 📞 获取帮助

如果遇到问题：
1. 查看应用内的帮助文档
2. 检查浏览器控制台的错误信息
3. 查看 `TEST_SUMMARY.md` 了解功能测试情况
4. 查看 `.kiro/specs/module-selection-feature/` 目录下的规范文档

## 🎉 开始使用

现在就打开浏览器访问 http://localhost:8501，体验全新的模块选择功能吧！

记住：**第一次使用前，请先点击"清除数据"按钮！**
